<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>영화 추천 받기</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>

    <style>
      /* 이미지 기본 CSS */
      .img {
        width: 150px;
        height: 120px;
      }

      /* 빨간색 포커스 */
      .selected {
        border: 3px solid #770000;
      }

      /* 밝게하기 */
      .brighten {
        filter: brightness(140%);
      }
    </style>
  </head>
  <body>
    <div style="width: 90%; margin: 30px auto; text-align: center">
      <h3>ChatGPT 기반의 영화 추천 시스템</h3>
      <b>관심있는 이미지를 5개를 선택하세요.</b>
    </div>

    <div style="width: 90%; margin: 30px auto; text-align: center">
      {% for filename in filenames %}
      <img
        id="{{loop.index}}"
        name="recommend"
        src="/static/movie/images/{{filename}}.jpg"
        class="img"
        onclick="applyCSS(event)"
        data-value="0"
      />
      {% endfor %}

      <br /><br />
      <div id="result"></div>
      <br />
      <button type="button" id="send" class="btn btn-info btn-sm">
        추천 받기
      </button>
      <br />
      <div id="processing"></div>
    </div>
    <script type="module" src="../static/js/movie.js"></script>
    <script>
      function applyCSS(event) {
        const img = event.target; // click을 한 태그
        img.classList.toggle("selected"); // selected 클래스 추가/제거
        img.classList.toggle("brighten"); // brighten 클래스 추가/제거

        let sw = img.getAttribute("data-value"); // 값 추출, data-: 개발자가 추가한 속성
        if (sw == 0) {
          img.setAttribute("data-value", 1);
        } else {
          img.setAttribute("data-value", 0);
        }

        document.getElementById("result").innerHTML = ""; // 이미지 선택시 기존에 출력된 추천 영화 삭제
        document.getElementById("processing").innerHTML = ""; // 처리중 animation 삭제
      }
    </script>
  </body>
</html>
